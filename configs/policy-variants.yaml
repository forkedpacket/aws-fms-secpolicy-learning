# Tag-driven mapping for primary/secondary rule sets.

resourceDefaults:
  alb:
    resourceType: "AWS::ElasticLoadBalancingV2::LoadBalancer"
    scope: "REGIONAL"
    defaultAction: "ALLOW"
    managedRuleGroups:
      # Baseline AWS-managed rule group applied to every ALB.
      - vendor: "AWS"
        name: "AWSManagedRulesCommonRuleSet"

tagKeys:
  primary: "WafRulesetPrimary"
  secondary: "WafRulesetSecondary"

ruleSets:
  primary:
    ou-shared-edge:
      ruleGroups:
        - arn: "arn:aws:wafv2:us-west-2:123456789012:regional/rulegroup/ou-shared-edge/aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee"
    ou-shared-app:
      ruleGroups:
        - arn: "arn:aws:wafv2:us-west-2:123456789012:regional/rulegroup/ou-shared-app/bbbbbbbb-cccc-dddd-eeee-ffffffffffff"
  secondary:
    ou-shared-bot:
      ruleGroups:
        - arn: "arn:aws:wafv2:us-west-2:123456789012:regional/rulegroup/ou-shared-bot/cccccccc-dddd-eeee-ffff-111111111111"
    ou-shared-anon:
      ruleGroups:
        - arn: "arn:aws:wafv2:us-west-2:123456789012:regional/rulegroup/ou-shared-anon/dddddddd-eeee-ffff-1111-222222222222"

defaults:
  primary: "ou-shared-edge"
  secondary: "ou-shared-bot"
